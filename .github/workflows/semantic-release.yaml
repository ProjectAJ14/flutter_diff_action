name: ğŸ¯ Semantic Release

on:
  workflow_dispatch:  # ğŸ”„ Manual workflow trigger

jobs:
  create_release:    # ğŸ“¦ Create and publish release
    name: ğŸš€ Generate Release
    runs-on: ubuntu-latest
    permissions:
      contents: write        # ğŸ“ Repository content modification
      issues: write         # ğŸ« Issue management
      pull-requests: write  # ğŸ”€ Pull request management

    steps:
      - name: ğŸ“¥ Checkout Repository
        uses: actions/checkout@v4
        with:
          fetch-depth: 0     # ğŸ“š Full git history for versioning
          persist-credentials: false  # ğŸ”’ Security best practice

      - name: âš™ï¸ Setup Node.js Environment
        uses: actions/setup-node@v4.2.0

      - name: ğŸ”§ Configure Prerelease
        if: github.ref != 'refs/heads/main'
        run: mv .releaserc.prerelease.yaml .releaserc.yaml
        # ğŸ“‹ Apply prerelease configuration for non-main branches

      - name: ğŸ·ï¸ Generate Semantic Release
        uses: cycjimmy/semantic-release-action@v4.1.1
        id: semantic   # ğŸ” Reference for output steps
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}  # ğŸ”‘ Authentication

      - name: ğŸ“Š Display Release Information
        if: steps.semantic.outputs.new_release_published == 'true'
        run: |
          echo "ğŸ“Œ Release Version: ${{ steps.semantic.outputs.new_release_version }}"
          echo "â¬†ï¸ Major Version: ${{ steps.semantic.outputs.new_release_major_version }}"
          echo "â• Minor Version: ${{ steps.semantic.outputs.new_release_minor_version }}"
          echo "ğŸ”¨ Patch Version: ${{ steps.semantic.outputs.new_release_patch_version }}"